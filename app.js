document.addEventListener("DOMContentLoaded", () => {
    const messagesContainer = document.querySelector("#messages-container"); // –ö–æ–Ω—Ç–µ–π–Ω–µ—Ä —Å–æ–æ–±—â–µ–Ω–∏–π
    const sendButton = document.querySelector("#send-btn"); // –ö–Ω–æ–ø–∫–∞ –æ—Ç–ø—Ä–∞–≤–∫–∏
    const messageInput = document.querySelector("#message-input"); // –ü–æ–ª–µ –≤–≤–æ–¥–∞
    const clearHistoryBtn = document.querySelector("#clear-btn"); // –ö–Ω–æ–ø–∫–∞ –æ—á–∏—Å—Ç–∫–∏ —á–∞—Ç–∞

    // –ë–ª–æ–∫–∏—Ä—É–µ—Ç –æ—Ç–ø—Ä–∞–≤–∫—É —Å–ª–µ–¥—É—é—â–µ–≥–æ —Å–æ–æ–±—â–µ–Ω–∏—è, –ø–æ–∫–∞ —Ñ–æ—Ä–º–∏—Ä—É–µ—Ç—Å—è –æ—Ç–≤–µ—Ç
    let sendingInProgress = false;

    // –î–æ–±–∞–≤–ª—è–µ—Ç –Ω–æ–≤–æ–µ —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ —á–∞—Ç
    function addMessage(text, isUser) {
        let messageClass = isUser ? "user-message" : "bot-message"; // –û–ø—Ä–µ–¥–µ–ª—è–µ–º –∫–ª–∞—Å—Å —Å–æ–æ–±—â–µ–Ω–∏—è
        const messageItem = `
            <div class="message-item ${messageClass}">
                ${text}
            </div>
        `;
        messagesContainer.insertAdjacentHTML("beforeend", messageItem); // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –≤ –∫–æ–Ω–µ—Ü —Å–ø–∏—Å–∫–∞
        messagesContainer.scrollTo({ top: messagesContainer.scrollHeight }); // –ü—Ä–æ–∫—Ä—É—á–∏–≤–∞–µ–º –¥–æ –∫–æ–Ω—Ü–∞
    }

    // –†–∞—Å—à–∏—Ä–µ–Ω–Ω—ã–π —Å–ø–∏—Å–æ–∫ –¥–∏–∞–ª–æ–≥–æ–≤ –∏ –æ—Ç–≤–µ—Ç–æ–≤
    const botResponses = [
        ["–ü—Ä–∏–≤–µ—Ç", "–ü—Ä–∏–≤–µ—Ç! –†–∞–¥–∞ –Ω–∞—à–µ–π –±–µ—Å–µ–¥–µ!"],                         // –ü—Ä–∏–≤–µ—Ç—Å—Ç–≤–∏–µ
        ["–ü—Ä–∏–≤–µ—Ç –∫–∞–∫ —Ç–≤–æ–∏ –¥–µ–ª–∞", "–í—Å—ë –æ—Ç–ª–∏—á–Ω–æ! –ì–æ—Ç–æ–≤–∞ –ø–æ–¥–¥–µ—Ä–∂–∞—Ç—å –ª—é–±—É—é –∏–Ω–∏—Ü–∏–∞—Ç–∏–≤—É!"],
        ["–ö–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç", "–ú–µ–Ω—è –∑–æ–≤—É—Ç Violet Bot. –ê –∫–∞–∫ —Ç–µ–±—è –∑–æ–≤—É—Ç?"],                  // –ë–µ–∑ –∑–Ω–∞–∫–æ–≤ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è
        ["–ö–∞–∫–æ–π —Å–µ–≥–æ–¥–Ω—è –¥–µ–Ω—å", "–°–µ–≥–æ–¥–Ω—è –æ—Å–æ–±–µ–Ω–Ω—ã–π –¥–µ–Ω—å ‚Äî –Ω–∞—Å–ª–∞–∂–¥–∞–π—Å—è –∫–∞–∂–¥—ã–º –º–≥–Ω–æ–≤–µ–Ω–∏–µ–º!"],          // –ò–Ω—Ñ–æ—Ä–º–∞—Ü–∏—è –æ –¥–Ω–µ
        ["–ü–æ–¥–µ–ª–∏—Å—å —Ä–µ—Ü–µ–ø—Ç–æ–º –≤–∫—É—Å–Ω–æ–≥–æ –±–ª—é–¥–∞", "–ü—Ä–∏–≥–æ—Ç–æ–≤—å –æ–º–ª–µ—Ç —Å –≤–µ—Ç—á–∏–Ω–æ–π –∏ –ø–æ–º–∏–¥–æ—Ä–∞–º–∏ ‚Äî –ø–æ–ª—É—á–∞–µ—Ç—Å—è —Å—ã—Ç–Ω–æ –∏ –≤–∫—É—Å–Ω–æ!"],
        ["–†–∞—Å—Å–∫–∞–∂–∏ –∞–Ω–µ–∫–¥–æ—Ç", "–ü–æ—á–µ–º—É –ø—Ä–æ–≥—Ä–∞–º–º–∏—Å—Ç—ã –ª—é–±—è—Ç —Ç–µ–º–Ω–æ—Ç—É? –¢–∞–∫ –ª–µ–≥—á–µ –∑–∞–º–µ—Ç–∏—Ç—å –æ—à–∏–±–∫—É –≤ –∫–æ–¥–µ! üòè"],
        ["–ö–∞–∫–∏–µ —Å–æ–≤–µ—Ç—ã –ø–æ –∑–¥–æ—Ä–æ–≤–æ–º—É –æ–±—Ä–∞–∑—É –∂–∏–∑–Ω–∏", "–ü—Ä–∞–≤–∏–ª—å–Ω–æ–µ –ø–∏—Ç–∞–Ω–∏–µ, —Ñ–∏–∑–∏—á–µ—Å–∫–∞—è –∞–∫—Ç–∏–≤–Ω–æ—Å—Ç—å –∏ –¥–æ—Å—Ç–∞—Ç–æ—á–Ω—ã–π —Å–æ–Ω ‚Äî —Ç—Ä–∏ —Å—Ç–æ–ª–ø–∞ –∑–¥–æ—Ä–æ–≤–æ–≥–æ –æ–±—Ä–∞–∑–∞ –∂–∏–∑–Ω–∏!"],
        ["–ß—Ç–æ –ø–æ—Å–æ–≤–µ—Ç—É–µ—à—å –ø–æ—á–∏—Ç–∞—Ç—å", "–ö–Ω–∏–≥–∞ \"1984\" –î–∂–æ—Ä–¥–∂–∞ –û—Ä—É—ç–ª–ª–∞ ‚Äî —è—Ä–∫–∏–π –∞–Ω—Ç–∏—É—Ç–æ–ø–∏—á–µ—Å–∫–∏–π —Ä–æ–º–∞–Ω, –¥–æ—Å—Ç–æ–π–Ω—ã–π –≤–Ω–∏–º–∞–Ω–∏—è."],           // –ö–Ω–∏–≥–∞
        ["–ö–∞–∫–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø—Ä–æ–≤–æ–¥–∏—Ç—å –¥–æ—Å—É–≥", "–ü—Ä–æ–≤–µ–¥–∏ –≤—Ä–µ–º—è —Å –±–ª–∏–∑–∫–∏–º–∏, –∑–∞–π–º–∏—Ç–µ—Å—å —Å–ø–æ—Ä—Ç–æ–º –∏–ª–∏ –ø–æ–≥—Ä—É–∑–∏—Å—å –≤ —Ç–≤–æ—Ä—á–µ—Å—Ç–≤–æ ‚Äî –≥–ª–∞–≤–Ω–æ–µ, —á—Ç–æ–±—ã —ç—Ç–æ –ø—Ä–∏–Ω–æ—Å–∏–ª–æ —Ä–∞–¥–æ—Å—Ç—å!"],
        ["–ß—Ç–æ —Å–∫–∞–∂–µ—à—å –æ –ª—é–±–≤–∏", "–õ—é–±–æ–≤—å ‚Äî –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–µ —á—É–≤—Å—Ç–≤–æ, –∫–æ—Ç–æ—Ä–æ–µ –Ω–∞–ø–æ–ª–Ω—è–µ—Ç —Å–µ—Ä–¥—Ü–µ —Ç–µ–ø–ª–æ–º –∏ —Å–≤–µ—Ç–æ–º!"],
        ["–ß—Ç–æ –¥—É–º–∞–µ—à—å –æ –º—É–∑—ã–∫–µ", "–ú—É–∑—ã–∫–∞ —Å–ø–æ—Å–æ–±–Ω–∞ –∏—Å—Ü–µ–ª—è—Ç—å –¥—É—à—É –∏ –ø–æ–¥–Ω–∏–º–∞—Ç—å –Ω–∞—Å—Ç—Ä–æ–µ–Ω–∏–µ!"],
        ["–ö–∞–∫–æ–π —Ç–≤–æ–π –ª—é–±–∏–º—ã–π —Ü–≤–µ—Ç–æ–∫", "–†–æ–∑–∞ ‚Äî —Å–∏–º–≤–æ–ª –∫—Ä–∞—Å–æ—Ç—ã –∏ –Ω–µ–∂–Ω–æ—Å—Ç–∏. –ê —É —Ç–µ–±—è –µ—Å—Ç—å –ª—é–±–∏–º—ã–π —Ü–≤–µ—Ç–æ–∫?"],                   // –¶–≤–µ—Ç—ã
        ["–ö–∞–∫–æ–π —Ñ–∏–ª—å–º –ø–æ—Å–º–æ—Ç—Ä–µ—Ç—å", "–ü–æ—Å–º–æ—Ç—Ä–∏ —Ñ–∏–ª—å–º \"–§–æ—Ä—Ä–µ—Å—Ç –ì–∞–º–ø\" ‚Äî –≥–ª—É–±–æ–∫–∏–π –∏ —Ç—Ä–æ–≥–∞—Ç–µ–ª—å–Ω—ã–π —Ä–∞—Å—Å–∫–∞–∑ –æ —Å—É–¥—å–±–µ –ø—Ä–æ—Å—Ç–æ–≥–æ –ø–∞—Ä–Ω—è!"],
        ["–ö–∞–∫–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–æ—Ö—Ä–∞–Ω–∏—Ç—å —ç–Ω–µ—Ä–≥–∏—é", "–ú–µ–¥–∏—Ç–∞—Ü–∏—è, –π–æ–≥–∞ –∏ —Å–ø–æ–∫–æ–π–Ω—ã–π –æ—Ç–¥—ã—Ö –≤–æ—Å—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞—é—Ç —Å–∏–ª—ã –ª—É—á—à–µ –≤—Å–µ–≥–æ!"],
        ["–ß—Ç–æ –ø–æ—Å–æ–≤–µ—Ç—É–µ—à—å –ø–∏—Ç—å —É—Ç—Ä–æ–º", "–ù–∞—á–Ω–∏—Ç–µ –¥–µ–Ω—å —Å–æ —Å–≤–µ–∂–µ–≥–æ –∞–ø–µ–ª—å—Å–∏–Ω–æ–≤–æ–≥–æ —Å–æ–∫–∞ –∏–ª–∏ –∑–µ–ª—ë–Ω–æ–≥–æ —á–∞—è ‚Äî —Ö–æ—Ä–æ—à–µ–µ –Ω–∞—á–∞–ª–æ –ø—Ä–µ–∫—Ä–∞—Å–Ω–æ–≥–æ –¥–Ω—è!"],
        ["–ö–∞–∫–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± –ø–æ–¥–≥–æ—Ç–æ–≤–∏—Ç—å—Å—è –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º", "–†–µ–≥—É–ª—è—Ä–Ω–æ–µ –ø–æ–≤—Ç–æ—Ä–µ–Ω–∏–µ –º–∞—Ç–µ—Ä–∏–∞–ª–∞, –ø–æ–Ω–∏–º–∞–Ω–∏–µ –æ—Å–Ω–æ–≤ –∏ –ø—Ä–∞–∫—Ç–∏–∫–∞ —Ç–µ—Å—Ç–æ–≤ ‚Äî –ª—É—á—à–∞—è –ø–æ–¥–≥–æ—Ç–æ–≤–∫–∞ –∫ —ç–∫–∑–∞–º–µ–Ω–∞–º!"],
        ["–ö–∞–∫–æ–π —É —Ç–µ–±—è –ª—é–±–∏–º—ã–π –≥–æ—Ä–æ–¥", "–ú–æ—Å–∫–≤–∞ ‚Äî –æ–≥—Ä–æ–º–Ω—ã–π –º–µ–≥–∞–ø–æ–ª–∏—Å —Å –±–æ–≥–∞—Ç–æ–π –∏—Å—Ç–æ—Ä–∏–µ–π –∏ –∫—É–ª—å—Ç—É—Ä–Ω—ã–º –Ω–∞—Å–ª–µ–¥–∏–µ–º!"],
        ["–ß—Ç–æ –¥–µ–ª–∞—Ç—å –≤ –ø–ª–æ—Ö—É—é –ø–æ–≥–æ–¥—É", "–ó–∞–≤–∞—Ä–∏ –≥–æ—Ä—è—á–∏–π —á–∞–π, —É–∫—Ä–æ–π—Å—è –ø–ª–µ–¥–æ–º –∏ –ø—Ä–æ—á–∏—Ç–∞–π —Ö–æ—Ä–æ—à—É—é –∫–Ω–∏–≥—É ‚Äî –ø–æ–≥–æ–¥–∞ –Ω–µ –ø–æ–º–µ—Ö–∞ —Å—á–∞—Å—Ç—å—é!"],
        ["–ö–∞–∫–æ–π –ª—É—á—à–∏–π —Å–ø–æ—Å–æ–± —Å–Ω—è—Ç—å —Å—Ç—Ä–µ—Å—Å", "–°–ø–æ—Ä—Ç–∏–≤–Ω—ã–µ –Ω–∞–≥—Ä—É–∑–∫–∏, –ø—Ä–æ–≥—É–ª–∫–∞ –Ω–∞ —Å–≤–µ–∂–µ–º –≤–æ–∑–¥—É—Ö–µ –∏ –≤—Å—Ç—Ä–µ—á–∞ —Å –¥—Ä—É–∑—å—è–º–∏ —Ç–≤–æ—Ä—è—Ç —á—É–¥–µ—Å–∞!"],
        ["–ß—Ç–æ –¥–µ–ª–∞—Ç—å, –µ—Å–ª–∏ —É—Å—Ç–∞–ª", "–°–¥–µ–ª–∞–π –ø–µ—Ä–µ—Ä—ã–≤, –æ—Ç–¥–æ—Ö–Ω–∏ –∏ –ø–µ—Ä–µ–∫–ª—é—á–∏—Å—å –Ω–∞ —á—Ç–æ-—Ç–æ –ø—Ä–∏—è—Ç–Ω–æ–µ ‚Äî —É—Å—Ç–∞–ª–æ—Å—Ç—å –æ—Ç—Å—Ç—É–ø–∏—Ç —Å–∞–º–∞ —Å–æ–±–æ–π!"]
    ];

    // –ì–µ–Ω–µ—Ä–∞—Ü–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±–æ—Ç–∞
    function generateBotReply(userMessage) {
        // –ù–æ—Ä–º–∞–ª–∏–∑—É–µ–º –≤–≤–æ–¥ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è (—É–±–∏—Ä–∞–µ–º –∑–Ω–∞–∫–∏ –ø—Ä–µ–ø–∏–Ω–∞–Ω–∏—è –∏ –ø—Ä–∏–≤–æ–¥–∏–º –∫ –Ω–∏–∂–Ω–µ–º—É —Ä–µ–≥–∏—Å—Ç—Ä—É)
        const normalizedMessage = userMessage.replace(/[^a-z–∞-—è—ë\s]+/gi, '').trim().toLowerCase();

        for(const [question, answer] of botResponses) {
            if (normalizedMessage.includes(question.toLowerCase())) {
                return answer;
            }
        }
        return "–ö–∞–∂–µ—Ç—Å—è, —è –Ω–µ –ø–æ–Ω—è–ª–∞ –≤–∞—à –≤–æ–ø—Ä–æ—Å. –ü–æ–ø—Ä–æ–±—É–π—Ç–µ —Å—Ñ–æ—Ä–º—É–ª–∏—Ä–æ–≤–∞—Ç—å –∏–Ω–∞—á–µ!";
    }

    // –ò–º–∏—Ç–∞—Ü–∏—è –æ—Ç–ø—Ä–∞–≤–∫–∏ —Å–æ–æ–±—â–µ–Ω–∏—è –∏ –ø–æ–ª—É—á–µ–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ –æ—Ç –±–æ—Ç–∞
    function handleSendMessage() {
        const userText = messageInput.value.trim();
        if (!userText || sendingInProgress) return;

        // –£—Å—Ç–∞–Ω–∞–≤–ª–∏–≤–∞–µ–º —Å–æ—Å—Ç–æ—è–Ω–∏–µ –±–ª–æ–∫–∏—Ä–æ–≤–∫–∏ –æ—Ç–ø—Ä–∞–≤–∫–∏
        sendingInProgress = true;

        // –î–æ–±–∞–≤–ª—è–µ–º —Å–æ–æ–±—â–µ–Ω–∏–µ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è
        addMessage(userText, true);
        messageInput.value = ''; // –û—á–∏—â–∞–µ–º –ø–æ–ª–µ –≤–≤–æ–¥–∞

        // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∞–Ω–∏–º–∞—Ü–∏—é –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞
        showTypingIndicator();

        // –§–æ—Ä–º–∏—Ä—É–µ–º –æ—Ç–≤–µ—Ç –±–æ—Ç–∞ —Å –Ω–µ–±–æ–ª—å—à–æ–π –∑–∞–¥–µ—Ä–∂–∫–æ–π
        setTimeout(() => {
            hideTypingIndicator();
            const botResponse = generateBotReply(userText);
            addMessage(botResponse, false);
            sendingInProgress = false;
        }, 1500); // –í—Ä–µ–º—è –æ–∂–∏–¥–∞–Ω–∏—è –æ—Ç–≤–µ—Ç–∞ (1.5 —Å–µ–∫—É–Ω–¥—ã)
    }

    // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä "–ë–æ—Ç –ø–µ—á–∞—Ç–∞–µ—Ç..."
    function showTypingIndicator() {
        const indicator = `<div class="typing-indicator">Bot –ø–µ—á–∞—Ç–∞–µ—Ç...</div>`; // –î–æ–±–∞–≤–ª—è–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
        messagesContainer.insertAdjacentHTML("beforeend", indicator);
        messagesContainer.scrollTo({ top: messagesContainer.scrollHeight });
    }

    // –°–∫—Ä—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä
    function hideTypingIndicator() {
        const typingIndicator = document.querySelector(".typing-indicator");
        if (typingIndicator) {
            typingIndicator.remove();
        }
    }

    // –ü—Ä–∏—Å–æ–µ–¥–∏–Ω—è–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–æ–±—ã—Ç–∏–π
    sendButton.addEventListener('click', handleSendMessage); // –ù–∞–∑–Ω–∞—á–∞–µ–º –æ–±—Ä–∞–±–æ—Ç—á–∏–∫ –Ω–∞ –∫–Ω–æ–ø–∫—É –æ—Ç–ø—Ä–∞–≤–∫–∏
    messageInput.addEventListener('keyup', (event) => {
        if (event.key === 'Enter') {
            handleSendMessage(); // –û—Ç–ø—Ä–∞–≤–∫–∞ –ø–æ –Ω–∞–∂–∞—Ç–∏—é Enter
        }
    });
    clearHistoryBtn.addEventListener('click', () => {
        messagesContainer.innerHTML = ''; // –û—á–∏—Å—Ç–∫–∞ –∏—Å—Ç–æ—Ä–∏–∏ —Å–æ–æ–±—â–µ–Ω–∏–π
    });
});
